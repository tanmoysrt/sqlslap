## SQLSlap ğŸ‘‹

It's a CLI tool to generate fake data for database and simulate real world load test.

### Features

- [x] Fill database with fake data
- [x] Random Insert/Delete/Update operation
- [ ] Slow Query Simulation
- [ ] Deadlock Simulation

### Setup

Build and install on system

```bash
go build -o sqlslap .
mv ./sqlslap /usr/bin
```

SQLSlap requires a single `config.yaml` to provide it the metadata and config.

```yaml
connection_info:
  host: <db_host_ip>
  port: 3306
  user: root
  password: toor
databases:
  - name: bloggers_world
    schema: >
      CREATE TABLE users (
          id CHAR(36) NOT NULL, -- UUID
          username VARCHAR(255) NOT NULL,
          name VARCHAR(255) NOT NULL,
          email VARCHAR(255) NOT NULL,
          created_at DATETIME NOT NULL,
          PRIMARY KEY (id)
      ) ENGINE=InnoDB;

      CREATE TABLE posts (
          id CHAR(36) NOT NULL, -- UUID
          title VARCHAR(255) NOT NULL,
          content TEXT NOT NULL,
          created_at DATETIME NOT NULL,
          user_id CHAR(36) NOT NULL, -- Foreign key to users.id
          PRIMARY KEY (id),
          KEY user_id (user_id),
          CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
      ) ENGINE=InnoDB;

    tables:
      users:
        engine: InnoDB
        columns:
          - name: id
            generator: uuid
            primary_key: true
          - name: username
            generator: username
          - name: name
            generator: name
          - name: email
            generator: email
          - name: created_at
            generator: datetime
      posts:
        engine: InnoDB
        columns:
          - name: id
            generator: uuid
          - name: title
            generator: title
          - name: content
            generator: sentence
          - name: created_at
            generator: datetime
          - name: user_id
            generator: fk(users.id)
```

### Usage

- Cleanup and Re-create database tables
  ```bash
  sqlslap --db bloggers_world init-db
  ```
- Insert rows in database with generated fake datas

  ```bash
  sqlslap --db bloggers_world random insert --table users --clients 100
  ```

  **Output Format** -

  ```
  Job: Insert Job | Runners : 10
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Runner â”‚  Total   â”‚ Failed  â”‚ Op/s         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 0      â”‚ 460      â”‚ 0       â”‚ 28.75        â”‚
  â”‚ 1      â”‚ 433      â”‚ 0       â”‚ 27.06        â”‚
  â”‚ 2      â”‚ 428      â”‚ 0       â”‚ 26.75        â”‚
  â”‚ 3      â”‚ 430      â”‚ 0       â”‚ 26.87        â”‚
  â”‚ 4      â”‚ 460      â”‚ 0       â”‚ 28.75        â”‚
  â”‚ 5      â”‚ 460      â”‚ 0       â”‚ 28.75        â”‚
  â”‚ 6      â”‚ 459      â”‚ 0       â”‚ 28.68        â”‚
  â”‚ 7      â”‚ 434      â”‚ 0       â”‚ 27.12        â”‚
  â”‚ 8      â”‚ 433      â”‚ 0       â”‚ 27.06        â”‚
  â”‚ 9      â”‚ 460      â”‚ 0       â”‚ 28.75        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Total  â”‚ 4457     â”‚ 0       â”‚ 278.6        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ```

- Delete random rows
  ```bash
  sqlslap --db bloggers_world random delete --table users --clients 100
  ```
- Update random rows
  ```bash
  sqlslap --db bloggers_world random update --table users --clients 100
  ```
